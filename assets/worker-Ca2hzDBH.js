import{loadPyodide as o}from"https://cdn.jsdelivr.net/pyodide/v0.25.0/full/pyodide.mjs";self.onerror=function(e){self.postMessage({type:"error",message:`Worker Global Error: ${e.message} (${e.filename}:${e.lineno})`})};let s=null;async function r(){try{self.postMessage({type:"status",message:"Initializing Pyodide Runtime..."}),s=await o(),self.postMessage({type:"status",message:"Loading Python dependencies (numpy, micropip)..."}),await s.loadPackage(["numpy","micropip"]),self.postMessage({type:"status",message:"Pyodide Runtime Ready."})}catch(e){self.postMessage({type:"error",message:`Pyodide Init Failed: ${e.message}`})}}r();self.onmessage=async e=>{const{code:a}=e.data;if(!s){self.postMessage({type:"error",message:"Pyodide is still loading... please wait."});return}try{s.setStdout({batched:t=>self.postMessage({type:"output",message:t})}),s.setStderr({batched:t=>self.postMessage({type:"error",message:t})}),self.postMessage({type:"status",message:"Exec: Running..."}),await s.runPythonAsync(a),self.postMessage({type:"status",message:"Exec: Completed."})}catch(t){self.postMessage({type:"error",message:t.toString()})}};
